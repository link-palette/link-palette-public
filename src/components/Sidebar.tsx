"use client";

import { logout } from "@/actions/auth.action";
import { inter } from "@/app/fonts";
import { cn } from "@/lib/utils";
import Link from "next/link";
import { usePathname } from "next/navigation";
import {
  MdOutlineSupervisedUserCircle,
  MdOutlinePhotoLibrary,
  MdLink,
  MdExitToApp,
} from "react-icons/md";
import NavItemChild from "./NavItemChild";
import { Session } from "next-auth";

export default function Sidebar({
  session,
}: Readonly<{
  session: Session;
  children?: React.ReactNode;
}>) {
  const pathname = usePathname();
  const routes = [
    {
      icon: <MdOutlineSupervisedUserCircle className="size-5" />,
      label: "프로필 관리",
      href: "/profile",
    },
    {
      icon: <MdOutlinePhotoLibrary className="size-5" />,
      label: "스킨 관리",
      href: "/skins/bg-edit",
    },
    {
      icon: <MdLink className="size-5" />,
      label: "링크 관리",
      href: "/links",
    },
    {
      icon: <MdExitToApp className="size-5" />,
      label: "로그아웃",
      href: "#",
      formAction: logout,
    },
  ];

  return (
    <aside className="w-[254px] bg-white flex-shrink-0 border-r border-gray-200">
      <Link
        href={session ? "/" : "/"}
        className={cn(
          "flex justify-center gap-[10px] px-[11px] py-[28px]",
          inter.className
        )}>
        <svg
          width="200"
          height="50"
          viewBox="0 0 331 50"
          fill="none"
          xmlns="http://www.w3.org/2000/svg">
          <path
            d="M127.207 40H107.598V11.9922H113.203V34.3945H127.207V40ZM135.859 13.3984C135.859 13.8932 135.762 14.3555 135.566 14.7852C135.384 15.2148 135.13 15.5924 134.805 15.918C134.479 16.2305 134.095 16.4844 133.652 16.6797C133.223 16.862 132.76 16.9531 132.266 16.9531C131.771 16.9531 131.302 16.862 130.859 16.6797C130.43 16.4844 130.052 16.2305 129.727 15.918C129.414 15.5924 129.16 15.2148 128.965 14.7852C128.783 14.3555 128.691 13.8932 128.691 13.3984C128.691 12.9167 128.783 12.4609 128.965 12.0312C129.16 11.5885 129.414 11.2109 129.727 10.8984C130.052 10.5729 130.43 10.319 130.859 10.1367C131.302 9.94141 131.771 9.84375 132.266 9.84375C132.76 9.84375 133.223 9.94141 133.652 10.1367C134.095 10.319 134.479 10.5729 134.805 10.8984C135.13 11.2109 135.384 11.5885 135.566 12.0312C135.762 12.4609 135.859 12.9167 135.859 13.3984ZM134.941 40H129.57V19.082H134.941V40ZM144.355 40H139.023V19.082H140.312L142.07 21.1133C142.93 20.332 143.9 19.7331 144.98 19.3164C146.074 18.8867 147.214 18.6719 148.398 18.6719C149.674 18.6719 150.879 18.9193 152.012 19.4141C153.145 19.8958 154.134 20.5664 154.98 21.4258C155.827 22.2721 156.491 23.2682 156.973 24.4141C157.467 25.5469 157.715 26.7578 157.715 28.0469V40H152.383V28.0469C152.383 27.5 152.279 26.9857 152.07 26.5039C151.862 26.0091 151.576 25.5794 151.211 25.2148C150.846 24.8503 150.423 24.5638 149.941 24.3555C149.46 24.1471 148.945 24.043 148.398 24.043C147.839 24.043 147.311 24.1471 146.816 24.3555C146.322 24.5638 145.892 24.8503 145.527 25.2148C145.163 25.5794 144.876 26.0091 144.668 26.5039C144.46 26.9857 144.355 27.5 144.355 28.0469V40ZM166.895 40H161.523V10.7617H166.895V29.1992L174.844 19.1211H180.977L174.043 27.832L180.977 40H174.844L170.605 32.4023L166.895 37.3242V40ZM189.258 17.5977V28.8086H194.863C195.632 28.8086 196.354 28.6654 197.031 28.3789C197.708 28.0794 198.301 27.6758 198.809 27.168C199.316 26.6602 199.714 26.0677 200 25.3906C200.299 24.7005 200.449 23.9714 200.449 23.2031C200.449 22.4349 200.299 21.7122 200 21.0352C199.714 20.3451 199.316 19.7461 198.809 19.2383C198.301 18.7305 197.708 18.3333 197.031 18.0469C196.354 17.7474 195.632 17.5977 194.863 17.5977H189.258ZM189.258 40H183.652V11.9922H194.863C195.892 11.9922 196.882 12.1289 197.832 12.4023C198.783 12.6628 199.668 13.0404 200.488 13.5352C201.322 14.0169 202.077 14.6029 202.754 15.293C203.444 15.9701 204.03 16.7253 204.512 17.5586C205.007 18.3919 205.384 19.2839 205.645 20.2344C205.918 21.1849 206.055 22.1745 206.055 23.2031C206.055 24.7396 205.762 26.1914 205.176 27.5586C204.59 28.9128 203.789 30.0977 202.773 31.1133C201.758 32.1289 200.566 32.9297 199.199 33.5156C197.845 34.1016 196.4 34.3945 194.863 34.3945H189.258V40ZM229.043 40H227.754L225.684 37.1289C225.176 37.5846 224.635 38.0143 224.062 38.418C223.503 38.8086 222.91 39.1536 222.285 39.4531C221.66 39.7396 221.016 39.9674 220.352 40.1367C219.701 40.306 219.036 40.3906 218.359 40.3906C216.888 40.3906 215.501 40.1432 214.199 39.6484C212.91 39.1536 211.777 38.4375 210.801 37.5C209.837 36.5495 209.076 35.3906 208.516 34.0234C207.956 32.6562 207.676 31.1003 207.676 29.3555C207.676 27.7279 207.956 26.237 208.516 24.8828C209.076 23.5156 209.837 22.3438 210.801 21.3672C211.777 20.3906 212.91 19.6354 214.199 19.1016C215.501 18.5547 216.888 18.2812 218.359 18.2812C219.036 18.2812 219.707 18.3659 220.371 18.5352C221.035 18.7044 221.68 18.9388 222.305 19.2383C222.93 19.5378 223.522 19.8893 224.082 20.293C224.655 20.6966 225.189 21.1328 225.684 21.6016L227.754 19.1211H229.043V40ZM223.672 29.3555C223.672 28.6263 223.529 27.9232 223.242 27.2461C222.969 26.556 222.591 25.9505 222.109 25.4297C221.628 24.8958 221.061 24.4727 220.41 24.1602C219.772 23.8346 219.089 23.6719 218.359 23.6719C217.63 23.6719 216.94 23.7956 216.289 24.043C215.651 24.2904 215.091 24.6549 214.609 25.1367C214.141 25.6185 213.77 26.2174 213.496 26.9336C213.223 27.6367 213.086 28.444 213.086 29.3555C213.086 30.2669 213.223 31.0807 213.496 31.7969C213.77 32.5 214.141 33.0924 214.609 33.5742C215.091 34.056 215.651 34.4206 216.289 34.668C216.94 34.9154 217.63 35.0391 218.359 35.0391C219.089 35.0391 219.772 34.8828 220.41 34.5703C221.061 34.2448 221.628 33.8216 222.109 33.3008C222.591 32.7669 222.969 32.1615 223.242 31.4844C223.529 30.7943 223.672 30.0846 223.672 29.3555ZM238.496 40H233.125V10.7617H238.496V40ZM250.898 34.8828C251.107 34.9479 251.315 34.9935 251.523 35.0195C251.732 35.0326 251.94 35.0391 252.148 35.0391C252.669 35.0391 253.171 34.9674 253.652 34.8242C254.134 34.681 254.583 34.4792 255 34.2188C255.43 33.9453 255.807 33.6198 256.133 33.2422C256.471 32.8516 256.745 32.4219 256.953 31.9531L260.859 35.8789C260.365 36.582 259.792 37.2135 259.141 37.7734C258.503 38.3333 257.806 38.8086 257.051 39.1992C256.309 39.5898 255.521 39.8828 254.688 40.0781C253.867 40.2865 253.021 40.3906 252.148 40.3906C250.677 40.3906 249.29 40.1172 247.988 39.5703C246.699 39.0234 245.566 38.2617 244.59 37.2852C243.626 36.3086 242.865 35.1497 242.305 33.8086C241.745 32.4544 241.465 30.9701 241.465 29.3555C241.465 27.7018 241.745 26.1914 242.305 24.8242C242.865 23.457 243.626 22.2917 244.59 21.3281C245.566 20.3646 246.699 19.6159 247.988 19.082C249.29 18.5482 250.677 18.2812 252.148 18.2812C253.021 18.2812 253.874 18.3854 254.707 18.5938C255.54 18.8021 256.328 19.1016 257.07 19.4922C257.826 19.8828 258.529 20.3646 259.18 20.9375C259.831 21.4974 260.404 22.1289 260.898 22.832L250.898 34.8828ZM253.633 23.8867C253.385 23.7956 253.138 23.737 252.891 23.7109C252.656 23.6849 252.409 23.6719 252.148 23.6719C251.419 23.6719 250.729 23.8086 250.078 24.082C249.44 24.3424 248.88 24.7201 248.398 25.2148C247.93 25.7096 247.559 26.3086 247.285 27.0117C247.012 27.7018 246.875 28.4831 246.875 29.3555C246.875 29.5508 246.882 29.7721 246.895 30.0195C246.921 30.2669 246.953 30.5208 246.992 30.7812C247.044 31.0286 247.103 31.2695 247.168 31.5039C247.233 31.7383 247.318 31.9466 247.422 32.1289L253.633 23.8867ZM274.082 40C272.793 40 271.582 39.7591 270.449 39.2773C269.316 38.7826 268.32 38.112 267.461 37.2656C266.615 36.4062 265.944 35.4102 265.449 34.2773C264.967 33.1445 264.727 31.9336 264.727 30.6445V24.4336H262.129V19.1211H264.727V10.7617H270.039V19.1211H278.125V24.4336H270.039V30.6445C270.039 31.2044 270.143 31.7318 270.352 32.2266C270.56 32.7083 270.846 33.1315 271.211 33.4961C271.576 33.8607 272.005 34.1536 272.5 34.375C272.995 34.5833 273.522 34.6875 274.082 34.6875H278.125V40H274.082ZM291.621 40C290.332 40 289.121 39.7591 287.988 39.2773C286.855 38.7826 285.859 38.112 285 37.2656C284.154 36.4062 283.483 35.4102 282.988 34.2773C282.507 33.1445 282.266 31.9336 282.266 30.6445V24.4336H279.668V19.1211H282.266V10.7617H287.578V19.1211H295.664V24.4336H287.578V30.6445C287.578 31.2044 287.682 31.7318 287.891 32.2266C288.099 32.7083 288.385 33.1315 288.75 33.4961C289.115 33.8607 289.544 34.1536 290.039 34.375C290.534 34.5833 291.061 34.6875 291.621 34.6875H295.664V40H291.621ZM306.992 34.8828C307.201 34.9479 307.409 34.9935 307.617 35.0195C307.826 35.0326 308.034 35.0391 308.242 35.0391C308.763 35.0391 309.264 34.9674 309.746 34.8242C310.228 34.681 310.677 34.4792 311.094 34.2188C311.523 33.9453 311.901 33.6198 312.227 33.2422C312.565 32.8516 312.839 32.4219 313.047 31.9531L316.953 35.8789C316.458 36.582 315.885 37.2135 315.234 37.7734C314.596 38.3333 313.9 38.8086 313.145 39.1992C312.402 39.5898 311.615 39.8828 310.781 40.0781C309.961 40.2865 309.115 40.3906 308.242 40.3906C306.771 40.3906 305.384 40.1172 304.082 39.5703C302.793 39.0234 301.66 38.2617 300.684 37.2852C299.72 36.3086 298.958 35.1497 298.398 33.8086C297.839 32.4544 297.559 30.9701 297.559 29.3555C297.559 27.7018 297.839 26.1914 298.398 24.8242C298.958 23.457 299.72 22.2917 300.684 21.3281C301.66 20.3646 302.793 19.6159 304.082 19.082C305.384 18.5482 306.771 18.2812 308.242 18.2812C309.115 18.2812 309.967 18.3854 310.801 18.5938C311.634 18.8021 312.422 19.1016 313.164 19.4922C313.919 19.8828 314.622 20.3646 315.273 20.9375C315.924 21.4974 316.497 22.1289 316.992 22.832L306.992 34.8828ZM309.727 23.8867C309.479 23.7956 309.232 23.737 308.984 23.7109C308.75 23.6849 308.503 23.6719 308.242 23.6719C307.513 23.6719 306.823 23.8086 306.172 24.082C305.534 24.3424 304.974 24.7201 304.492 25.2148C304.023 25.7096 303.652 26.3086 303.379 27.0117C303.105 27.7018 302.969 28.4831 302.969 29.3555C302.969 29.5508 302.975 29.7721 302.988 30.0195C303.014 30.2669 303.047 30.5208 303.086 30.7812C303.138 31.0286 303.197 31.2695 303.262 31.5039C303.327 31.7383 303.411 31.9466 303.516 32.1289L309.727 23.8867Z"
            fill="black"
          />
          <path
            d="M68.0861 3.00023C97.8825 2.99997 52.2058 20.274 75.7198 15.7079C122.739 6.57746 39.9804 82.0222 23.558 23.6329C22.8727 21.1965 25.5667 19.3898 27.6682 20.8003V20.8003C31.7378 23.5318 30.6446 29.5339 25.7512 29.8129C-3.98875 31.5085 -16.9485 6.42526 55.0699 3"
            stroke="black"
            strokeWidth="3"
            strokeLinecap="round"
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M40.6596 30.9556C41.5545 30.8772 42.2541 31.6663 42.9531 32.2904C43.7825 33.0311 44.9909 33.6514 44.9999 34.8316C45.009 36.0132 43.8441 36.7051 42.9922 37.4161C42.2965 37.9967 41.521 38.5968 40.6596 38.4538C39.8661 38.3221 39.4406 37.4325 38.9349 36.7425C38.5068 36.1584 38.0473 35.5824 38.0045 34.8316C37.959 34.0353 38.2666 33.2982 38.702 32.6626C39.2238 31.9008 39.799 31.0309 40.6596 30.9556Z"
            fill="#FF5A5A"
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M72.5194 24.5C73.2297 24.5051 73.8251 25.1061 74.2956 25.763C74.7339 26.3748 75.0431 27.1415 74.9951 27.9561C74.9497 28.7243 74.5 29.3123 74.0544 29.8513C73.6151 30.3824 73.1341 30.938 72.5194 30.9498C71.8982 30.9618 71.4474 30.3469 70.9358 29.9115C70.2226 29.3045 69.0564 29.0234 69.0019 27.9561C68.9477 26.8938 70.0481 26.4003 70.7226 25.7376C71.2805 25.1894 71.8065 24.4949 72.5194 24.5Z"
            fill="#7F0BFD"
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M58.1366 32.2831C59.0662 32.2378 60.06 31.7078 60.8217 32.312C61.6534 32.9717 62.0157 34.1989 61.9995 35.3473C61.9835 36.4795 61.4608 37.5039 60.7375 38.2873C60.0309 39.0527 59.1078 39.6663 58.1366 39.5311C57.2322 39.4052 56.6919 38.4315 56.106 37.6426C55.594 36.9531 55.1057 36.2434 55.0294 35.3473C54.9449 34.3546 55.0089 33.2187 55.6736 32.5632C56.32 31.9257 57.2796 32.3249 58.1366 32.2831Z"
            fill="#FFC900"
          />
        </svg>
      </Link>

      <nav className="flex flex-col gap-[15px]">
        {routes.map((route) => {
          return route.formAction ? (
            <form action={route.formAction} key={route.label}>
              <button type="submit" className="w-full">
                <NavItemChild label={route.label} icon={route.icon} />
              </button>
            </form>
          ) : (
            <Link key={route.label} href={route.href}>
              <NavItemChild
                active={route.href.split("/")[1] === pathname.split("/")[1]}
                label={route.label}
                icon={route.icon}
              />
            </Link>
          );
        })}
      </nav>
    </aside>
  );
}
